# OWASP Top 10 2021

## A01:2021 - Broken Access Control

**Description:** Failures in access control allow unauthorized users to access data or functionality.

**Common Examples:**
- IDOR (Insecure Direct Object References) - accessing other users' data by changing IDs
- Missing authorization checks on API endpoints
- Privilege escalation (regular user gains admin access)
- Forced browsing to authenticated pages

**Test For:**
- Change user IDs in URLs/requests
- Try admin endpoints as regular user
- Access other users' resources

**Remediation:**
- Implement authorization checks on every endpoint
- Use indirect references (tokens, not user-supplied IDs)
- Default deny access
- Log authorization failures

## A02:2021 - Cryptographic Failures

**Description:** Failures in cryptography leading to exposure of sensitive data.

**Common Examples:**
- Unencrypted data transmission (HTTP instead of HTTPS)
- Weak encryption algorithms (DES, MD5, SHA1)
- Hardcoded encryption keys
- Unencrypted database fields containing PII

**Test For:**
- HTTP connections
- Weak SSL/TLS versions
- Sensitive data in logs or error messages
- Database encryption status

**Remediation:**
- Use TLS 1.3 for all connections
- Use AES-256 for encryption
- Never hardcode keys (use secret managers)
- Encrypt sensitive database columns

## A03:2021 - Injection

**Description:** Untrusted data sent to an interpreter as part of a command or query.

**Types:**
- SQL Injection
- NoSQL Injection
- OS Command Injection
- LDAP Injection
- XSS (Cross-Site Scripting)

**Test Payloads:**
- SQL: `' OR '1'='1`
- Command: `; ls -la`
- XSS: `<script>alert('XSS')</script>`

**Remediation:**
- Use parameterized queries (prepared statements)
- Use ORMs properly
- Input validation (whitelist)
- Output encoding
- Avoid shell commands with user input

## A04:2021 - Insecure Design

**Description:** Missing or ineffective security design patterns.

**Common Examples:**
- Missing rate limiting
- No account lockout after failed logins
- Credential recovery without proper verification
- Business logic flaws

**Test For:**
- Unlimited API requests
- Password reset vulnerabilities
- Race conditions in critical operations

**Remediation:**
- Threat modeling during design
- Rate limiting on all endpoints
- Account lockout policies
- Secure workflow design

## A05:2021 - Security Misconfiguration

**Description:** Insecure default configurations, incomplete setups, verbose errors.

**Common Examples:**
- Default credentials (admin/admin)
- Directory listing enabled
- Verbose error messages revealing stack traces
- Unnecessary features enabled
- Missing security headers

**Test For:**
- Try default credentials
- Access /admin, /.git, /.env
- Trigger errors to see stack traces
- Check security headers

**Remediation:**
- Change all default credentials
- Disable directory listing
- Generic error messages in production
- Remove unused features
- Implement security headers

## A06:2021 - Vulnerable and Outdated Components

**Description:** Using components with known vulnerabilities.

**Common Examples:**
- Outdated libraries (jQuery 1.x, lodash <4.17.19)
- Unpatched frameworks
- Unused dependencies with vulnerabilities

**Test For:**
- Run npm audit / pip-audit
- Check dependency versions
- Look for CVEs in libraries

**Remediation:**
- Regular dependency updates
- Automated vulnerability scanning
- Remove unused dependencies
- Subscribe to security advisories

## A07:2021 - Identification and Authentication Failures

**Description:** Failures in authentication and session management.

**Common Examples:**
- Weak passwords allowed
- Credential stuffing (no rate limiting)
- Session fixation
- Predictable session IDs
- Missing MFA

**Test For:**
- Try weak passwords
- Brute force login
- Session token predictability
- Session timeout

**Remediation:**
- Strong password policies
- MFA for sensitive accounts
- Account lockout after failed attempts
- Secure session management
- Password breach detection

## A08:2021 - Software and Data Integrity Failures

**Description:** Code and infrastructure without integrity verification.

**Common Examples:**
- Unsigned updates
- Insecure CI/CD pipelines
- Unverified object deserialization
- Dependencies from untrusted sources

**Test For:**
- Check update mechanism security
- Deserialization of untrusted data
- CI/CD security controls

**Remediation:**
- Code signing
- Dependency verification (checksums)
- Secure CI/CD pipeline
- Avoid deserializing untrusted data

## A09:2021 - Security Logging and Monitoring Failures

**Description:** Insufficient logging and monitoring of security events.

**Common Examples:**
- No logging of login attempts
- No alerting on suspicious activity
- Logs not retained or protected
- No incident response plan

**Test For:**
- Verify login failures are logged
- Check if suspicious activity triggers alerts
- Test log integrity

**Remediation:**
- Log all authentication events
- Log authorization failures
- Centralized logging (SIEM)
- Real-time alerting
- Tamper-proof logs

## A10:2021 - Server-Side Request Forgery (SSRF)

**Description:** Application fetches a remote resource without validating user-supplied URL.

**Common Examples:**
- URL parameters fetched by server
- Webhook URLs not validated
- File upload from URL

**Test Payloads:**
- `http://localhost/admin`
- `http://169.254.169.254/latest/meta-data/` (AWS metadata)
- `file:///etc/passwd`

**Remediation:**
- Whitelist allowed domains
- Validate and sanitize URLs
- Disable unnecessary URL schemes (file://, gopher://)
- Network segmentation
