# Common Weakness Enumeration (CWE) Reference

## Most Critical CWEs

### CWE-89: SQL Injection
**Description:** SQL queries constructed with unsanitized user input
**Impact:** Data breach, authentication bypass, data modification
**Example:** `query = f"SELECT * FROM users WHERE id = {user_id}"`
**Fix:** Use parameterized queries

### CWE-79: Cross-Site Scripting (XSS)
**Description:** Untrusted data included in web page without validation/escaping
**Impact:** Session hijacking, malware distribution, phishing
**Example:** `<div>${userInput}</div>` without escaping
**Fix:** Encode output, sanitize input, use CSP

### CWE-787: Out-of-bounds Write
**Description:** Writing data past the end of a buffer
**Impact:** Code execution, DoS, memory corruption
**Example:** Buffer overflow in C/C++
**Fix:** Bounds checking, use safe functions

### CWE-20: Improper Input Validation
**Description:** Insufficient validation of user input
**Impact:** Various attacks (injection, DoS, etc.)
**Example:** No validation on email field
**Fix:** Whitelist validation, type checking

### CWE-125: Out-of-bounds Read
**Description:** Reading data past the end of a buffer
**Impact:** Information disclosure, DoS
**Example:** Array index out of bounds
**Fix:** Bounds checking

### CWE-78: OS Command Injection
**Description:** OS commands constructed with unsanitized user input
**Impact:** System compromise, data theft
**Example:** `os.system(f"ping {user_input}")`
**Fix:** Avoid shell commands, use APIs

### CWE-416: Use After Free
**Description:** Using memory after it has been freed
**Impact:** Code execution, memory corruption
**Example:** Accessing freed pointer
**Fix:** Nullify pointers after free

### CWE-22: Path Traversal
**Description:** User controls file path without restriction
**Impact:** Unauthorized file access
**Example:** `open(f"/files/{user_filename}")`
**Fix:** Validate paths, use whitelist

### CWE-352: Cross-Site Request Forgery (CSRF)
**Description:** Unauthorized commands transmitted from trusted user
**Impact:** Unauthorized actions
**Example:** State-changing GET requests
**Fix:** CSRF tokens, SameSite cookies

### CWE-434: Unrestricted Upload of File with Dangerous Type
**Description:** Allows upload of dangerous file types
**Impact:** Code execution, defacement
**Example:** No validation on uploaded files
**Fix:** Whitelist allowed types, virus scanning

## Access Control CWEs

### CWE-639: Insecure Direct Object References (IDOR)
**Description:** Access to objects using user-supplied identifiers without authorization
**Example:** `/api/users/{id}` without checking ownership
**Fix:** Authorization checks, indirect references

### CWE-862: Missing Authorization
**Description:** Missing authorization checks
**Example:** Admin endpoints accessible to all authenticated users
**Fix:** Implement authorization checks

### CWE-863: Incorrect Authorization
**Description:** Incorrect authorization logic
**Example:** Using user role from client-side
**Fix:** Server-side authorization

## Authentication CWEs

### CWE-798: Use of Hard-coded Credentials
**Description:** Credentials embedded in source code
**Example:** `password = "admin123"`
**Fix:** Use secret managers, environment variables

### CWE-759: Use of Password Hash With Insufficient Computational Effort
**Description:** Weak password hashing
**Example:** MD5, SHA1 for passwords
**Fix:** Use bcrypt, scrypt, or Argon2

### CWE-307: Improper Restriction of Excessive Authentication Attempts
**Description:** No limit on login attempts
**Example:** Unlimited password guessing
**Fix:** Account lockout, rate limiting

## Cryptography CWEs

### CWE-327: Use of Broken Cryptographic Algorithm
**Description:** Using weak crypto algorithms
**Example:** DES, MD5, SHA1
**Fix:** Use AES-256, SHA-256+

### CWE-330: Use of Insufficiently Random Values
**Description:** Predictable random values
**Example:** `random.seed(1)` for security
**Fix:** Use cryptographically secure RNG

## Information Disclosure CWEs

### CWE-200: Exposure of Sensitive Information
**Description:** Sensitive data exposed to unauthorized parties
**Example:** PII in API responses
**Fix:** Filter sensitive fields

### CWE-209: Information Exposure Through Error Messages
**Description:** Detailed error messages reveal system information
**Example:** Stack traces in production
**Fix:** Generic error messages

## Deserialization CWEs

### CWE-502: Deserialization of Untrusted Data
**Description:** Deserializing user-controlled data
**Example:** `pickle.loads(user_data)`
**Fix:** Avoid deserialization, use JSON

## Session Management CWEs

### CWE-384: Session Fixation
**Description:** Attacker sets victim's session ID
**Example:** Not regenerating session ID after login
**Fix:** Regenerate session ID after authentication
